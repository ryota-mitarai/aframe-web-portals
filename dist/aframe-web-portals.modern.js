!function(e){function t(i){if(s[i])return s[i].exports;var n=s[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var s={};t.m=e,t.c=s,t.p="",t(0)}([function(e,t){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var s={childList:!0,attributes:!0,subtree:!0};AFRAME.registerComponent("aabb-collider",{schema:{collideNonVisible:{default:!1},debug:{default:!1},enabled:{default:!0},interval:{default:80},objects:{default:""}},init:function(){this.centerDifferenceVec3=new THREE.Vector3,this.clearedIntersectedEls=[],this.closestIntersectedEl=null,this.boundingBox=new THREE.Box3,this.boxCenter=new THREE.Vector3,this.boxHelper=new THREE.BoxHelper,this.boxMax=new THREE.Vector3,this.boxMin=new THREE.Vector3,this.hitClosestClearEventDetail={},this.hitClosestEventDetail={},this.intersectedEls=[],this.objectEls=[],this.newIntersectedEls=[],this.prevCheckTime=void 0,this.previousIntersectedEls=[],this.setDirty=this.setDirty.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.hitStartEventDetail={intersectedEls:this.newIntersectedEls}},play:function(){this.observer.observe(this.el.sceneEl,s),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty)},remove:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},tick:function(e){var t,s,i,n,o=this.boundingBox,l=this.centerDifferenceVec3,r=this.clearedIntersectedEls,c=this.intersectedEls,h=this.el,a=this.newIntersectedEls,d=this.objectEls,b=this.prevCheckTime,u=this.previousIntersectedEls;if(this.data.enabled&&!(b&&e-b<this.data.interval)){for(this.prevCheckTime=e,this.dirty&&this.refreshObjects(),o.setFromObject(h.object3D),this.boxMin.copy(o.min),this.boxMax.copy(o.max),o.getCenter(this.boxCenter),this.data.debug&&(this.boxHelper.setFromObject(h.object3D),this.boxHelper.parent||h.sceneEl.object3D.add(this.boxHelper)),function(e,t){var s;for(e.length=0,s=0;s<t.length;s++)e[s]=t[s]}(u,c),c.length=0,n=0;n<d.length;n++)d[n]!==this.el&&(this.data.collideNonVisible||d[n].getAttribute("visible")?this.isIntersecting(d[n])&&c.push(d[n]):this.data.debug&&(t=d[n].object3D.boxHelper)&&(h.sceneEl.object3D.remove(t),d[n].object3D.boxHelper=null));for(a.length=0,n=0;n<c.length;n++)-1===u.indexOf(c[n])&&a.push(c[n]);for(r.length=0,n=0;n<u.length;n++)-1===c.indexOf(u[n])&&(u[n].hasAttribute("aabb-collider")||u[n].emit("hitend"),r.push(u[n]));for(n=0;n<a.length;n++)a[n]!==this.el&&(a[n].hasAttribute("aabb-collider")||a[n].emit("hitstart"));for(n=0;n<c.length;n++)c[n]!==this.el&&(l.copy(c[n].object3D.boundingBoxCenter).sub(this.boxCenter),(void 0===s||l.length()<s)&&(s=l.length(),i=c[n]));!c.length&&this.closestIntersectedEl?(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit("hitclosestclear"),this.closestIntersectedEl=null,h.emit("hitclosestclear",this.hitClosestClearEventDetail)):i!==this.closestIntersectedEl&&(this.closestIntersectedEl&&(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit("hitclosestclear",this.hitClosestClearEventDetail)),i&&(i.emit("hitclosest"),this.closestIntersectedEl=i,this.hitClosestEventDetail.el=i,h.emit("hitclosest",this.hitClosestEventDetail))),r.length&&h.emit("hitend"),a.length&&h.emit("hitstart",this.hitStartEventDetail)}},isIntersecting:function(){var e=new THREE.Box3;return function(t){var s,i;return e.setFromObject(t.object3D),this.data.debug&&(t.object3D.boxHelper||(t.object3D.boxHelper=new THREE.BoxHelper(t.object3D,new THREE.Color(Math.random(),Math.random(),Math.random())),t.sceneEl.object3D.add(t.object3D.boxHelper)),t.object3D.boxHelper.setFromObject(t.object3D)),s=e.min,i=e.max,t.object3D.boundingBoxCenter=t.object3D.boundingBoxCenter||new THREE.Vector3,e.getCenter(t.object3D.boundingBoxCenter),this.boxMin.x<=i.x&&this.boxMax.x>=s.x&&this.boxMin.y<=i.y&&this.boxMax.y>=s.y&&this.boxMin.z<=i.z&&this.boxMax.z>=s.z}}(),setDirty:function(){this.dirty=!0},refreshObjects:function(){var e=this.data;this.objectEls=e.objects?this.el.sceneEl.querySelectorAll(e.objects):this.el.sceneEl.children,this.dirty=!1}})}]),AFRAME.registerComponent("web-portal",{schema:{url:{default:""},iframe:{default:""},player:{default:""},text:{default:""},portalFrame:{default:!0}},init:function(){const e=this.el,t=this.data,s=e.sceneEl;if(e.setAttribute("geometry",{primitive:"plane",width:1.5,height:2.4}),e.setAttribute("material",{color:"#faf"}),""===t.player)return void console.error("aframe-web-portal: player not defined");var i;document.querySelector(t.player),e.setAttribute("aabb-collider",{objects:t.player}),""!==t.iframe?i=document.querySelector(t.iframe):((i=document.createElement("iframe")).style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%",i.style.overflow="none",i.style.zIndex=-10,i.style.display="none",document.body.appendChild(i)),i.src=t.url;const n=document.createElement("a-text");if(n.setAttribute("value",t.text),n.setAttribute("position","0 1.75 .4"),n.setAttribute("align","center"),e.appendChild(n),t.titleEl=n,1==t.portalFrame){const t=document.createElement("a-box");t.setAttribute("position",".75 0 .24"),t.setAttribute("scale",".25 2.6 .5"),e.appendChild(t);const s=document.createElement("a-box");s.setAttribute("position","-.75 0 .24"),s.setAttribute("scale",".25 2.6 .5"),e.appendChild(s);const i=document.createElement("a-box");i.setAttribute("position","0 1.2 .24"),i.setAttribute("scale","1.7 .25 .5"),e.appendChild(i);const n=document.createElement("a-box");n.setAttribute("position","0 0 -.06"),n.setAttribute("scale","1.6 2.5 .1"),e.appendChild(n)}e.addEventListener("hitstart",function(){console.log("hit"),s.style.zIndex=-10,s.style.display="none",i.style.zIndex=10,i.style.display="block",document.exitPointerLock()})},update:function(){const e=this.data;e.titleEl.setAttribute("value",e.text)}});
//# sourceMappingURL=aframe-web-portals.modern.js.map
